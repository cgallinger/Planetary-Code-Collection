CC = gfortran
C90 = gfortran
CFLAGS = -O3 -Wall
C90FLAGS = -O3 -Wall  # -fopenmp
LFLAGS = -O3 -Wall    # -fopenmp

#CC = g77
#C90 = g95
#CFLAGS = -O3 -Wall
#C90FLAGS = -O3 -Wall
#LFLAGS = -O3 -Wall

#CC = ifort
#C90 = ifort
#CFLAGS = -O3 -warn all -warn notruncated_source
#C90FLAGS = -O3 -warn all
#LFLAGS = -O3 -warn all


exper_thermal: $< tridag.o vapordiffusioni.o psv.o \
	adsorption.o conductionT.o exper_thermal1d.o grids.o \
	makefile
	$(CC) $(LFLAGS) exper_thermal1d.o conductionT.o tridag.o \
	vapordiffusioni.o psv.o adsorption.o grids.o

mars_thermal: mars_thermal1d.o julday.o marsorbit.o flux.o \
	conductionQ.o tridag.o conductionT.o grids.o \
	psv.o makefile
	$(CC) $(LFLAGS) mars_thermal1d.o julday.o marsorbit.o \
	flux.o conductionQ.o tridag.o conductionT.o grids.o \
	psv.o

mars_mapt: mars_mapt2.o julday.o marsorbit.o flux.o \
	conductionQ.o tridag.o conductionT.o grids.o \
	jsub.o psv.o makefile
	$(CC) $(LFLAGS) mars_mapt2.o julday.o marsorbit.o \
	flux.o conductionQ.o tridag.o conductionT.o grids.o \
	jsub.o psv.o

mars_mapi: mars_mapi.o julday.o marsorbit.o flux.o \
	conductionQ.o tridag.o conductionT.o grids.o \
	psv.o jsub.o makefile
	$(CC) $(LFLAGS) mars_mapi.o julday.o marsorbit.o \
	flux.o conductionQ.o tridag.o conductionT.o grids.o \
	psv.o jsub.o

mars_mapiqh2v: mars_mapiqh2v.o90 julday.o marsorbit.o flux.o \
	conductionQ.o tridag.o90 conductionT.o grids.o psv.o \
	jsubv.o90 makefile
	$(C90) $(LFLAGS) mars_mapiqh2v.o90 julday.o marsorbit.o \
	flux.o conductionQ.o tridag.o90 conductionT.o grids.o \
	psv.o jsubv.o90 

stabgrow_fast: fast_modules.o90 fast_subs_exper.o90 \
	stabgrow_fast.o90 fast_subs_univ.o90 tridag.o90 conductionT.o \
	grids.o psv.o derivs.o90 makefile 
	$(C90) $(LFLAGS) stabgrow_fast.o90 tridag.o90 conductionT.o \
	grids.o psv.o derivs.o90 fast_subs_univ.o90 fast_subs_exper.o90

exper_fast: fast_modules.o90 exper_fast.o90 fast_subs_univ.o90 \
	fast_subs_exper.o90 tridag.o90 conductionT.o grids.o \
	psv.o derivs.o90 makefile
	$(C90) $(LFLAGS) exper_fast.o90 tridag.o90 conductionT.o \
	grids.o psv.o derivs.o90 fast_subs_univ.o90 \
	fast_subs_exper.o90 

mars_fast: fast_modules.o90 mars_fast.o90 fast_subs_univ.o90 \
	fast_subs_mars.o90 tridag.o90 conductionT.o conductionQ.o \
	grids.o psv.o derivs.o90 generalorbit.o flux.o psvco2.o \
	makefile
	$(C90) $(LFLAGS) mars_fast.o90 tridag.o90 conductionT.o \
	grids.o psv.o flux.o derivs.o90 fast_subs_univ.o90 \
	conductionQ.o psvco2.o generalorbit.o \
	fast_subs_mars.o90


julday.o: julday.for makefile   # NR routine without pause statement
	$(CC) $(CFLAGS) -c julday.for

%.o:	%.f makefile
	$(CC) $(CFLAGS) -c $<

#.f.o:	%.f makefile
#	$(CC) $(CFLAGS) -c $<

%.o90:	%.f90 makefile
	$(C90) $(C90FLAGS) -c $<  -o $*.o90

%.o90:	%.f makefile  # f77 routines that need to be compiled with f95
	$(C90) $(C90FLAGS) -c $<  -o $*.o90

clean:
	rm -f  *.o  a.out  *.o90  *.mod

